<ion-toolbar>
  <ion-buttons slot="start">
    <ion-menu-button (click)="open()" menu="first"></ion-menu-button>
  </ion-buttons>
  <ion-title>Categories</ion-title>
</ion-toolbar>

<ion-content>
  <div *ngFor="let category of categories" class="categories">
    <div class="cat-nm" id="list-modal-{{ category._id }}">
      <h1>
        {{ category.category_name }}
      </h1>
    </div>
    <div class="action-btn">
      <ion-icon
        class="edit-btn"
        name="create-outline"
        id="open-modal-{{ category._id }}"
        expand="block"
        (click)="passInfo(category._id, category.category_name)"
      ></ion-icon>
    </div>
    <div class="action-btn">
      <ion-icon
        class="delete-btn"
        name="trash-outline"
        (click)="deleteCategory(category._id)"
      ></ion-icon>
    </div>

    <!-- Edit Modal -->
    <ion-modal
      trigger="open-modal-{{ category._id }}"
      (willDismiss)="onWillDismiss($event)"
      #updateModal
    >
      <ng-template>
        <ion-header>
          <ion-toolbar>
            <ion-buttons slot="start">
              <ion-button (click)="updateModal.dismiss(null, 'cancel')"
                >Cancel</ion-button
              >
            </ion-buttons>
            <ion-buttons slot="end">
              <ion-button
                (click)="updateModal.dismiss(null, 'update')"
                [strong]="true"
              >
                Update
              </ion-button>
            </ion-buttons>
          </ion-toolbar>
        </ion-header>
        <ion-content class="ion-padding">
          <ion-item>
            <ion-input
              type="text"
              placeholder="Category"
              [(ngModel)]="inputValue"
            ></ion-input>
          </ion-item>
        </ion-content>
      </ng-template>
    </ion-modal>
  </div>
</ion-content>

<ion-modal
  #modal
  *ngFor="let category of categories"
  trigger="list-modal-{{ category._id }}"
>
  <ng-template>
    <ion-header>
      <ion-toolbar>
        <ion-title>{{ category.category_name }}</ion-title>
        <ion-buttons slot="end">
          <ion-button (click)="modal.dismiss()">Close</ion-button>
        </ion-buttons>
      </ion-toolbar>
    </ion-header>
    <ion-content>
      <ion-list>
        <ion-item
          *ngFor="
            let shoppingItem of items
              | itemByCategory: 'categoryID':category._id
          "
        >
          <ion-label>
            <h2>{{ shoppingItem["item_name"] }}</h2>
            <p>{{ shoppingItem["price"] }}</p>
            <p>{{ shoppingItem["quantity"] }}</p>
          </ion-label>
        </ion-item>
      </ion-list>
    </ion-content>
  </ng-template>
</ion-modal>
